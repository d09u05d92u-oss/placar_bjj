<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Placar de Jiu-Jitsu Avançado</title>
  <style>
    body {
      background-color: #000;
      color: #fff;
      font-family: 'Arial', sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      user-select: none;
      overflow: hidden;
    }
    .score-container { display: flex; flex-direction: column; align-items: center; width: 100%; height: 100%; background-color: #000; padding: 10px; border-radius: 10px; }
    .player-names { display: flex; justify-content: space-between; align-items: center; width: 100%; margin-bottom: 20px; }
    .player-name { width: 45%; background-color: #333; border: none; color: #fff; text-align: center; padding: 15px; font-size: 2em; border-radius: 5px; text-transform: uppercase; }
    .player-name::placeholder { color: #aaa; }
    .gif-container { width: 50px; height: 50px; display: flex; justify-content: center; align-items: center; margin: 0 10px; }
    .gif-container img { width: 100%; height: auto; }
    .score-row { display: flex; width: 100%; justify-content: space-between; margin-bottom: 10px; flex-grow: 1; flex-wrap: wrap; }
    .score-box { display: flex; flex-direction: column; align-items: center; justify-content: center; flex-grow: 1; margin: 5px; border-radius: 5px; cursor: pointer; text-align: center; font-weight: bold; transition: transform 0.1s ease-in-out; position: relative; }
    .score-box:active { transform: scale(0.95); }
    .score-text { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); display: flex; flex-direction: column; align-items: center; justify-content: center; line-height: 1; }
    .label { font-size: 2.5em; text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5); }
    .score-value { font-size: 6em; text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5); }
    .white { background-color: #fff; color: #000; }
    .red { background-color: #d11a1a; color: #fff; }
    .yellow { background-color: #ffc107; color: #000; }
    .green { background-color: #4CAF50; color: #fff; }
    .blue { background-color: #1a4cd1; color: #fff; }
    .timer-container { display: flex; align-items: center; justify-content: center; width: 100%; margin: 20px 0; }
    .timer-display { font-size: 7em; color: #d11a1a; font-family: 'Digital-7', sans-serif; margin: 0 20px; min-width: 200px; text-align: center; }
    .timer-controls { display: flex; flex-direction: column; align-items: center; }
    .timer-controls button { background: none; border: none; cursor: pointer; color: #fff; font-size: 1.5em; padding: 5px; }
    .timer-buttons { display: flex; justify-content: space-between; width: 100px; }
    .timer-buttons button { background: none; border: none; cursor: pointer; padding: 10px; }
    #resetTimer { color: #fff; }
    #startStopTimer { color: #fff; }
    .timer-buttons svg { fill: currentColor; width: 24px; height: 24px; }
    .total { pointer-events: none; cursor: default; } /* bloqueia clique nos totais */
    @media (max-width: 768px) {
      .player-names { flex-direction: column; align-items: center; }
      .player-name { width: 80%; font-size: 1.5em; margin-bottom: 10px; }
      .gif-container { width: 40px; height: 40px; margin-top: 10px; margin-bottom: 20px; }
      .score-row { justify-content: center; }
      .score-box { flex-basis: 45%; margin: 5px; height: 100px; }
      .label { font-size: 1.5em; }
      .score-value { font-size: 3em; }
      .timer-container { flex-direction: column; }
      .timer-display { font-size: 4em; margin: 10px 0; }
    }
  </style>
</head>
<body>
  <audio id="startSound" src="https://www.myinstants.com/media/sounds/apito_2.mp3"></audio>
  <audio id="endSound" src="https://www.myinstants.com/media/sounds/apito_3.mp3"></audio>

  <div class="score-container">
    <div class="player-names">
      <input type="text" id="player2Name" placeholder="Player 2" class="player-name">
      <div class="gif-container">
        <img src="https://res.cloudinary.com/ddozlstmp/image/upload/v1755625626/lv_0_20250819144633_yun7o2.gif" alt="Placar GIF">
      </div>
      <input type="text" id="player1Name" placeholder="Player 1" class="player-name">
    </div>

    <!-- Placar -->
    <div class="score-row">
      <div class="score-box red" onclick="addPoints(2, 'penalty')">
        <div class="score-text"><span class="label">P</span><span id="player2Penalty" class="score-value">0</span></div>
      </div>
      <div class="score-box yellow" onclick="addPoints(2, 'advantage')">
        <div class="score-text"><span class="label">V</span><span id="player2Advantage" class="score-value">0</span></div>
      </div>
      <div class="score-box white total"><div class="score-text"><span id="player2TotalPoints" class="score-value">0</span></div></div>
      <div class="score-box green total"><div class="score-text"><span id="player1TotalPoints" class="score-value">0</span></div></div>
      <div class="score-box yellow" onclick="addPoints(1, 'advantage')">
        <div class="score-text"><span class="label">V</span><span id="player1Advantage" class="score-value">0</span></div>
      </div>
      <div class="score-box red" onclick="addPoints(1, 'penalty')">
        <div class="score-text"><span class="label">P</span><span id="player1Penalty" class="score-value">0</span></div>
      </div>
    </div>

    <!-- Timer -->
    <div class="timer-container">
      <div class="timer-controls">
        <button id="addMinute">+</button>
        <button id="subtractMinute">-</button>
      </div>
      <div id="timer" class="timer-display">5:00</div>
      <div class="timer-buttons">
        <button id="resetTimer">R</button>
        <button id="startStopTimer">▶</button>
      </div>
    </div>

    <!-- Botões de pontos -->
    <div class="score-row">
      <div class="score-box white" onclick="addPoints(2, 'points', 4)">
        <div class="score-text"><span class="label">4</span><span id="player2Points4" class="score-value">0</span></div>
      </div>
      <div class="score-box white" onclick="addPoints(2, 'points', 3)">
        <div class="score-text"><span class="label">3</span><span id="player2Points3" class="score-value">0</span></div>
      </div>
      <div class="score-box white" onclick="addPoints(2, 'points', 2)">
        <div class="score-text"><span class="label">2</span><span id="player2Points2" class="score-value">0</span></div>
      </div>
      <div class="score-box green" onclick="addPoints(1, 'points', 2)">
        <div class="score-text"><span class="label">2</span><span id="player1Points2" class="score-value">0</span></div>
      </div>
      <div class="score-box green" onclick="addPoints(1, 'points', 3)">
        <div class="score-text"><span class="label">3</span><span id="player1Points3" class="score-value">0</span></div>
      </div>
      <div class="score-box green" onclick="addPoints(1, 'points', 4)">
        <div class="score-text"><span class="label">4</span><span id="player1Points4" class="score-value">0</span></div>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const scoreElements = {
        player1: { points: {2:0,3:0,4:0}, advantage:0, penalty:0, total:0 },
        player2: { points: {2:0,3:0,4:0}, advantage:0, penalty:0, total:0 }
      };

      function updateScoreDisplay() {
        document.getElementById('player1Advantage').textContent = scoreElements.player1.advantage;
        document.getElementById('player1Penalty').textContent = scoreElements.player1.penalty;
        document.getElementById('player2Advantage').textContent = scoreElements.player2.advantage;
        document.getElementById('player2Penalty').textContent = scoreElements.player2.penalty;

        document.getElementById('player1Points2').textContent = scoreElements.player1.points[2];
        document.getElementById('player1Points3').textContent = scoreElements.player1.points[3];
        document.getElementById('player1Points4').textContent = scoreElements.player1.points[4];
        document.getElementById('player2Points2').textContent = scoreElements.player2.points[2];
        document.getElementById('player2Points3').textContent = scoreElements.player2.points[3];
        document.getElementById('player2Points4').textContent = scoreElements.player2.points[4];

        scoreElements.player1.total = (scoreElements.player1.points[2]*2)+(scoreElements.player1.points[3]*3)+(scoreElements.player1.points[4]*4);
        scoreElements.player2.total = (scoreElements.player2.points[2]*2)+(scoreElements.player2.points[3]*3)+(scoreElements.player2.points[4]*4);

        document.getElementById('player1TotalPoints').textContent = scoreElements.player1.total;
        document.getElementById('player2TotalPoints').textContent = scoreElements.player2.total;
      }

      window.addPoints = (player, type, value=1, subtract=false) => {
        const p = player===1 ? "player1" : "player2";
        if(type==="points") {
          if(subtract && scoreElements[p].points[value]>0) scoreElements[p].points[value]--;
          else if(!subtract) scoreElements[p].points[value]++;
        } else {
          if(subtract && scoreElements[p][type]>0) scoreElements[p][type]--;
          else if(!subtract) scoreElements[p][type]++;
        }
        updateScoreDisplay();
      };

      // clique direito para diminuir
      document.querySelectorAll('.score-box:not(.total)').forEach(box=>{
        box.addEventListener('contextmenu',e=>{
          e.preventDefault();
          const attr = box.getAttribute('onclick');
          if(attr){
            const args = attr.match(/addPoints\((.*?)\)/)[1].split(',').map(a=>a.trim());
            const player = parseInt(args[0]);
            const type = args[1].replace(/['"]/g,'');
            const value = args[2] ? parseInt(args[2]) : 1;
            addPoints(player, type, value, true);
          }
        });
      });

      updateScoreDisplay();

      // ---- TIMER ----
      let timerDisplay = document.getElementById("timer");
      let startStopBtn = document.getElementById("startStopTimer");
      let resetBtn = document.getElementById("resetTimer");
      let addMinuteBtn = document.getElementById("addMinute");
      let subtractMinuteBtn = document.getElementById("subtractMinute");

      let defaultDuration = 300; // 5 min em segundos
      let remainingTime = defaultDuration;
      let timerInterval = null;
      let running = false;

      function renderTime() {
        let minutes = Math.floor(remainingTime / 60);
        let seconds = remainingTime % 60;
        timerDisplay.textContent = `${minutes}:${seconds.toString().padStart(2,"0")}`;
      }

      function startTimer() {
        if (running) return;
        running = true;
        document.getElementById("startSound").play();
        startStopBtn.textContent = "⏸";
        timerInterval = setInterval(()=>{
          if (remainingTime > 0) {
            remainingTime--;
            renderTime();
          } else {
            clearInterval(timerInterval);
            running = false;
            document.getElementById("endSound").play();
            startStopBtn.textContent = "▶";
          }
        },1000);
      }

      function stopTimer() {
        running = false;
        clearInterval(timerInterval);
        startStopBtn.textContent = "▶";
      }

      function resetTimer() {
        stopTimer();
        remainingTime = defaultDuration;
        renderTime();
        // zerar todos os pontos
        scoreElements.player1 = { points: {2:0,3:0,4:0}, advantage:0, penalty:0, total:0 };
        scoreElements.player2 = { points: {2:0,3:0,4:0}, advantage:0, penalty:0, total:0 };
        updateScoreDisplay();
      }

      startStopBtn.addEventListener("click", ()=>{
        if(running) stopTimer();
        else startTimer();
      });

      resetBtn.addEventListener("click", resetTimer);

      addMinuteBtn.addEventListener("click", ()=>{
        remainingTime += 60;
        defaultDuration = remainingTime;
        renderTime();
      });

      subtractMinuteBtn.addEventListener("click", ()=>{
        if(remainingTime > 60) {
          remainingTime -= 60;
          defaultDuration = remainingTime;
          renderTime();
        }
      });

      renderTime();
    });
  </script>
</body>
</html>
